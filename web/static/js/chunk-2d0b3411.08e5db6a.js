(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2d0b3411"],{"281f":function(e,t,r){"use strict";r.r(t);var s=r("967e"),n=r.n(s),a=(r("96cf"),r("3b8d")),i=(r("7514"),r("ac6a"),r("7f7f"),r("365c")),o={name:"group",data:function(){var e=this;return{selectCount:0,selectList:{},filterIndexList:[],roleList:[],userModalVisible:!1,permisiteVisible:!1,modalTitle:"",searchForm:{pageNum:1,pageSize:10},userForm:{name:""},userFormValidate:{name:[{required:!0,message:$t("routerMenu.theUserGroupEmpty"),trigger:"blur"},{validator:this.valiLoginName,trigger:"blur"}]},columns:[{title:$t("routerMenu.orderNumbNer"),type:"index",align:"center"},{title:$t("routerMenu.creater"),key:"name",align:"center",renderHeader:function(t,r){var s=r.column,n=r.index;if(e.$refs.table)return t("span",e.$refs.table.$scopedSlots.name({column:s,index:n}))}},{title:$t("routerMenu.creater"),key:"createName",align:"center",minWidth:150,renderHeader:function(t,r){var s=r.column,n=r.index;if(e.$refs.table)return t("span",e.$refs.table.$scopedSlots.createName({column:s,index:n}))}},{title:$t("routerMenu.creationTime"),key:"createTime",align:"center",sortable:!0,minWidth:170},{title:$t("routerMenu.operate"),key:"",align:"center",render:function(t,r){return t("div",[t("Button",{props:{type:"info",size:"small",icon:"md-flower",disabled:"administrators"===r.row.name},style:{marginRight:"5px"},on:{click:function(){e.edit(r.row)}}},$t("routerMenu.assignPermissions")),t("Button",{props:{type:"error",size:"small",icon:"md-close",disabled:"administrators"===r.row.name,loading:e.$store.state.loadingList[r.index]},style:{marginRight:"5px"},on:{click:function(){e.remove(r.row,r.index)}}},$t("routerMenu.delete"))])}}],data:[],AllGroup:[],sysIndeterminate:!1,sysAll:!1,sysAllGroupChangeArr:["face_sys_set","face_sys_param","face_sys_log","face_device_exception_push","face_dev_list","face_user","face_user_group","face_hardware_upgrade","face_logo_set"],menuList:["face_dev_group","face_monface_tior_center","face_lists","face_snap","face_control"],formIndeterminate:!1,formAll:!1,total:0,userName:"",modalType:0}},methods:{init:function(){this.getRoleList()},handlesysAll:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.sysIndeterminate?this.sysAll=!1:this.sysAll=!this.sysAll,1===t?this.sysAll=!0:-1===t&&(this.sysAll=!1),this.sysIndeterminate=!1,this.sysAll?this.sysAllGroupChangeArr.forEach((function(t){e.AllGroup.find((function(e){return e==t}))||e.AllGroup.push(t)})):this.sysAllGroupChangeArr.forEach((function(t){var r=e.AllGroup.indexOf(t);-1!==r&&e.AllGroup.splice(r,1)})),this.isFormAll()},sysAllGroupChange:function(e){var t=[];this.sysAllGroupChangeArr.forEach((function(r){-1!==e.indexOf(r)&&t.push(r)})),t.length===this.sysAllGroupChangeArr.length?(this.sysIndeterminate=!1,this.sysAll=!0):t.length>0?(this.sysIndeterminate=!0,this.sysAll=!1):(this.sysIndeterminate=!1,this.sysAll=!1),this.isFormAll()},handlemenuList:function(){var e=this;1===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?this.menuList.forEach((function(t){e.AllGroup.find((function(e){return e==t}))||e.AllGroup.push(t)})):this.menuList.forEach((function(t){var r=e.AllGroup.indexOf(t);-1!==r&&e.AllGroup.splice(r,1)})),this.isFormAll()},menuListllGroupChange:function(e){this.isFormAll()},isFormAll:function(){var e=this.AllGroup.length;e===this.sysAllGroupChangeArr.length+this.menuList.length?(this.formIndeterminate=!1,this.formAll=!0):e>0?(this.formIndeterminate=!0,this.formAll=!1):(this.formIndeterminate=!1,this.formAll=!1)},changePage:function(e){this.searchForm.pageNum=e,this.selectList={},this.getRoleList()},changePageSize:function(e){this.searchForm.pageNum=1,this.searchForm.pageSize=e,this.selectList={},this.getRoleList()},handleSearch:function(){this.searchForm.pageNum=1,this.searchForm.pageSize=10,this.getRoleList()},getRoleList:function(){var e=Object(a.a)(n.a.mark((function e(){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.c.findAllRole(this.searchForm);case 2:(t=e.sent)&&(this.data=t.data.list,this.total=t.data.total);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),valiLoginName:function(e,t,r){""==this.userForm.id?i.c.isRepeatRole({name:t},"non-form").then((function(e){e?e.data?r(new Error($t("routerMenu.userGroupReenter"))):r():r(new Error($t("routerMenu.verifyIsAbnormal")))})):r()},handleformAll:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.AllGroup=[],this.formIndeterminate?this.formAll=!1:this.formAll=!this.formAll,this.formIndeterminate=!1,-1===e&&(this.formAll=!1),this.formAll?(this.handlesysAll(1),this.handlemenuList(1)):(this.handlesysAll(-1),this.handlemenuList(-1))},addUser:function(){this.handleformAll(-1),this.modalType=0,this.modalTitle=$t("routerMenu.add"),this.$refs.userForm.resetFields(),this.userForm.id="",this.userModalVisible=!0},submitUser:function(){var e=Object(a.a)(n.a.mark((function e(){var t,r;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$refs.userForm.validate();case 2:if(!e.sent){e.next=22;break}if(this.userName===this.userForm.name.trim()){e.next=16;break}if(1!=this.modalType){e.next=10;break}return e.next=7,i.c.updateRole(this.userForm,"_");case 7:e.t0=e.sent,e.next=13;break;case 10:return e.next=12,i.c.addRole(this.userForm,"_");case 12:e.t0=e.sent;case 13:if(t=e.t0){e.next=16;break}return e.abrupt("return");case 16:return e.next=18,this.addUpdateRoleMenu(t&&t.data||this.userForm.id);case 18:(r=e.sent)&&this.$Message.success(r),this.init(),this.userModalVisible=!1;case 22:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),addUpdateRoleMenu:function(){var e=Object(a.a)(n.a.mark((function e(t){var r,s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={id:0,menuCodeList:this.AllGroup.map((function(e){return e.toUpperCase()})),menuId:0,roleId:t,menuType:2},e.next=3,i.c.updateRoleMenu(r,"_");case 3:if(!(s=e.sent)){e.next=8;break}return e.abrupt("return",s.msg||$t("routerMenu.operationSucces"));case 8:return e.abrupt("return","");case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),edit:function(e){this.modalType=1,this.modalTitle=$t("routerMenu.edit"),this.$refs.userForm.resetFields(),this.userForm.name=e.name,this.userForm.id=e.id,this.userName=e.name,this.getRoleInfo(e),this.userModalVisible=!0},getRoleInfo:function(){var e=Object(a.a)(n.a.mark((function e(t){var r,s,a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.handleformAll(-1),e.next=3,i.c.getRoleMenuView({roleId:t.id,menuType:2},"form");case 3:if((r=e.sent)&&r.dataList&&r.dataList.length){for(s=[],a=0;a<r.dataList.length;a++)s.push(r.dataList[a].code.toLowerCase());this.AllGroup=s,this.isFormAll(),this.sysAllGroupChange(s)}case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=Object(a.a)(n.a.mark((function e(t,r){var s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$Modal.confirm({title:$t("routerMenu.confirmDeletion"),content:$t("routerMenu.confirmDelete")+t.name+" ?"});case 2:if(!e.sent){e.next=8;break}return this.$store.commit("loadingList",r),e.next=6,i.c.deleteRole({id:t.id},"form-non");case 6:(s=e.sent)&&(this.$Message.success(s.msg),this.init());case 8:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},mounted:function(){this.init()}},l=r("2877"),u=Object(l.a)(o,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"i-table-no-border selection"},[r("div",{staticClass:"pageHeader"},[r("h4",[e._v(e._s(e.$t("routerMenu.userGroupMgmt")))]),r("div",{staticClass:"buttons"},[r("Button",{attrs:{icon:"md-refresh",loading:e.$store.state.loading},on:{click:function(t){return e.$emit("handleReload")}}},[e._v(e._s(e.$t("routerMenu.resetting")))]),r("Button",{attrs:{type:"success",icon:"md-add",loading:e.$store.state.loading},on:{click:e.addUser}},[e._v(e._s(e.$t("routerMenu.add")))])],1)]),r("Card",{staticClass:"ivu-mt",attrs:{bordered:!1,"dis-hover":""}},[r("Table",{ref:"table",staticClass:"ivu-mt",attrs:{height:e.data.length>=11?520:"",columns:e.columns,data:e.data,loading:e.$store.state.loading},scopedSlots:e._u([{key:"name",fn:function(t){var s=t.column,n=t.index;return[r("filter-search",{attrs:{column:s,index:n,searchForm:e.searchForm,searchKey:"name"},on:{handleSearch:e.handleSearch}})]}},{key:"createName",fn:function(t){var s=t.column,n=t.index;return[r("filter-search",{attrs:{column:s,index:n,searchForm:e.searchForm,searchKey:"createName"},on:{handleSearch:e.handleSearch}})]}}])}),r("div",{staticClass:"ivu-mt ivu-text-center"},[r("Page",{attrs:{current:e.searchForm.pageNum,total:e.total,"page-size":e.searchForm.pageSize,"page-size-opts":[10,20,50,100],"show-total":"","show-elevator":"","show-sizer":""},on:{"on-change":e.changePage,"on-page-size-change":e.changePageSize}})],1)],1),r("Modal",{attrs:{title:e.modalTitle,"mask-closable":!1,width:800},model:{value:e.userModalVisible,callback:function(t){e.userModalVisible=t},expression:"userModalVisible"}},[e.$store.state.loading?r("Spin",{attrs:{size:"large",fix:""}}):e._e(),r("Form",{ref:"userForm",attrs:{model:e.userForm,"label-width":98,rules:e.userFormValidate}},[r("FormItem",{attrs:{label:e.$t("routerMenu.group"),prop:"name"}},[r("Input",{attrs:{maxlength:20},model:{value:e.userForm.name,callback:function(t){e.$set(e.userForm,"name",t)},expression:"userForm.name"}})],1),r("Card",[r("div",{staticStyle:{"border-bottom":"1px solid #e9e9e9","padding-bottom":"6px","margin-bottom":"4px"}},[r("Checkbox",{attrs:{indeterminate:e.sysIndeterminate,value:e.sysAll},nativeOn:{click:function(t){return t.preventDefault(),e.handlesysAll(t)}}},[r("span",{staticStyle:{"margin-left":"6px"}},[e._v(e._s(e.$t("routerMenu.systemMgmt")))])])],1),r("FormItem",{staticStyle:{"margin-bottom":"0px"},attrs:{label:""}},[r("CheckboxGroup",{on:{"on-change":e.sysAllGroupChange},model:{value:e.AllGroup,callback:function(t){e.AllGroup=t},expression:"AllGroup"}},[r("Checkbox",{staticStyle:{"margin-left":"10px"},attrs:{label:"face_sys_set"}},[e._v("\n                            "+e._s(e.$t("routerMenu.faceSettings")))]),r("Checkbox",{staticStyle:{"margin-left":"10px"},attrs:{label:"face_dev_list"}},[e._v("\n                            "+e._s(e.$t("routerMenu.faceRecognitionEquipment")))]),r("Checkbox",{staticStyle:{"margin-left":"10px"},attrs:{label:"face_sys_param"}},[e._v("\n                            "+e._s(e.$t("routerMenu.systemParameters")))]),r("Checkbox",{staticStyle:{"margin-left":"10px"},attrs:{label:"face_user"}},[e._v(e._s(e.$t("routerMenu.userMgmt"))+"\n                        ")]),r("Checkbox",{staticStyle:{"margin-left":"10px"},attrs:{label:"face_user_group"}},[e._v("\n                            "+e._s(e.$t("routerMenu.userGroupMgmt")))]),r("Checkbox",{staticStyle:{"margin-left":"10px"},attrs:{label:"face_hardware_upgrade"}},[e._v("\n                            "+e._s(e.$t("routerMenu.softwareUpgrade")))]),r("Checkbox",{staticStyle:{"margin-left":"10px"},attrs:{label:"face_logo_set"}},[e._v(" "+e._s(e.$t("routerMenu.logoSettings"))+"\n                        ")]),r("Checkbox",{staticStyle:{"margin-left":"10px"},attrs:{label:"face_sys_log"}},[e._v("\n                            "+e._s(e.$t("routerMenu.DeviceOperationLog")))]),r("Checkbox",{staticStyle:{"margin-left":"10px"},attrs:{label:"face_device_exception_push"}},[e._v("\n                            "+e._s(e.$t("routerMenu.faceDeviceExceptionPush")))])],1)],1)],1),r("Card",{staticStyle:{"margin-top":"14px"}},[r("CheckboxGroup",{on:{"on-change":e.menuListllGroupChange},model:{value:e.AllGroup,callback:function(t){e.AllGroup=t},expression:"AllGroup"}},[r("Checkbox",{staticStyle:{margin:"6px 18px 0 0"},attrs:{label:"face_monface_tior_center"}},[e._v("\n                        "+e._s(e.$t("routerMenu.faceMonitorCenter")))]),r("Checkbox",{staticStyle:{margin:"6px 18px 0 0"},attrs:{label:"face_lists"}},[e._v("\n                        "+e._s(e.$t("routerMenu.personnelList"))+"\n                    ")]),r("Checkbox",{staticStyle:{margin:"6px 18px 0 0"},attrs:{label:"face_dev_group"}},[e._v("\n                        "+e._s(e.$t("routerMenu.deviceGroupMgmt")))]),r("Checkbox",{staticStyle:{margin:"6px 18px 0 0"},attrs:{label:"face_snap"}},[e._v(e._s(e.$t("routerMenu.captureRecord"))+"\n                    ")])],1)],1)],1),r("div",{attrs:{slot:"footer"},slot:"footer"},[r("Checkbox",{staticStyle:{float:"left","line-height":"35px","font-size":"14px"},attrs:{indeterminate:e.formIndeterminate,value:e.formAll},nativeOn:{click:function(t){return t.preventDefault(),e.handleformAll(t)}}},[e._v(" "+e._s(e.$t("routerMenu.all")))]),r("Button",{attrs:{type:"text"},on:{click:function(t){e.userModalVisible=!1}}},[e._v(e._s(e.$t("routerMenu.cancel")))]),r("Button",{attrs:{type:"primary",loading:e.$store.state._loading},on:{click:e.submitUser}},[e._v(e._s(e.$t("routerMenu.save")))])],1)],1)],1)}),[],!1,null,null,null);t.default=u.exports}}]);