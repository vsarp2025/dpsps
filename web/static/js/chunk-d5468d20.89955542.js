(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-d5468d20"],{8749:function(t,e,s){"use strict";s.r(e),s("4917"),s("28a5");var n=s("967e"),a=s.n(n),r=(s("96cf"),s("3b8d")),i=(s("7f7f"),s("5a0c")),o=s.n(i),u=s("365c"),l=s("a09b"),c=s("2d95"),p=[{name:$t("routerMenu.serviceUpgrade"),vtype:2}],d={name:"upgrade_pack",components:{XUpload:l.a},props:["userInfo"],data:function(){return{searchForm:{pageNum:1,pageSize:10,vtype:-1},uploadVisbale:!1,planTimeStatus:!1,disabled:!1,uploadForm:{upgradeType:0,planTime:"",vtype:0,vsoft:"",newPath:null},upHead:{accessToken:c.a.get("token")},vsoft:"V6.0.0.0",vtypeList:p,data:[],total:0,successTime:!1,timeOut:60,myTimeOut:null,isModalVisible:!1,isClearing:!1,dataItems:[$t("routerMenu.operationLog"),$t("routerMenu.inOutHistory"),$t("routerMenu.rechargeDetails"),$t("routerMenu.chargeDetails"),$t("routerMenu.alternateShiftDetails"),$t("routerMenu.summaryDetails"),$t("routerMenu.exceptionOpenRecords"),$t("routerMenu.monthsRentCarMgmt"),$t("routerMenu.parkingInnerVehicle"),$t("routerMenu.discountDeatl")]}},computed:{columns:function(){var t=this,e=[{title:$t("routerMenu.orderNumbNer"),type:"index",align:"center"},{title:$t("routerMenu.oldVersion"),key:"voldSoft",align:"center",sortable:!0},{title:$t("routerMenu.newVersion"),key:"vsoft",align:"center",sortable:!0},{title:$t("routerMenu.versionType"),key:"vtype",align:"center",render:function(t,e){return t("div",$t("routerMenu.serviceUpgrade"))},filters:p.map((function(t){return{label:t.name,value:t.vtype}})),filterMultiple:!1,filterRemote:function(e,s,n){e&&(t.searchForm.vtype=e[0],t.handleSearch())}},{title:$t("routerMenu.updateDate"),key:"createTime",align:"center",sortable:!0},{title:$t("routerMenu.operatingPersonnel"),key:"createName",align:"center"},{title:$t("routerMenu.status"),key:"status",align:"center",minWidth:100,render:function(e,s){return s.row.vsoft==s.row.latestVersion?e("div",$t("routerMenu.finish")):2==+s.row.vtype?e("div","-"):e("div",0===t.userInfo.isSensData?[s.row.latestVersion,e("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px",marginLeft:"30px"},on:{click:function(){t.msgClick(s.row)}}},$t("routerMenu.toUpgrade"))]:"")}}];return e},getVerName:function(){var t=this.uploadForm.vtype;return"V6.x.x.x.x.x".concat(0==t?"":".zip")}},methods:{init:function(){this.getVersionData()},getVersionData:function(){var t=Object(r.a)(a.a.mark((function t(){var e;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.a.getVersionData(Object.assign({},this.searchForm,{vtype:-1==this.searchForm.vtype?null:this.searchForm.vtype}));case 2:(e=t.sent)&&(this.data=e.data.list,this.total=e.data.total);case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),handleSearch:function(){this.searchForm.pageNum=1,this.searchForm.pageSize=10,this.init()},changePage:function(t){this.searchForm.pageNum=t,this.init()},changePageSize:function(t){this.searchForm.pageNum=1,this.searchForm.pageSize=t,this.init()},initForm:function(){this.uploadForm.planTime="",this.uploadForm.upPlan=1,this.uploadForm.upgradeType=0,this.planTimeStatus=!0,this.uploadForm.newPath=null,this.uploadVisbale=!0},showModal:function(){this.uploadForm.vtype=2,this.$refs.upload.clearFiles(),this.initForm(),this.getUploadData()},msgClick:function(){var t=Object(r.a)(a.a.mark((function t(e){var s;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e._index=null,e._rowKey=null,e.upgradeType="0",t.next=5,u.a.singleChanelUpgrade(JSON.parse(JSON.stringify(e)));case 5:(s=t.sent)&&this.$Message.success(s.msg);case 7:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),switchVtype:function(t){this.initForm(),this.$refs.upload.clearFiles(),this.getUploadData(t)},getUploadData:function(){var t=Object(r.a)(a.a.mark((function t(){var e,s,n=arguments;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.length>0&&void 0!==n[0]?n[0]:this.uploadForm.vtype,t.next=3,u.a.findLatest("","non",e);case 3:(s=t.sent)&&(this.vsoft=s.data.vsoft||"V6.0.0.0.0.0");case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),handleUpdate:function(){var t=Object(r.a)(a.a.mark((function t(){var e,s,n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this,(s={newPath:this.uploadForm.newPath,planTime:this.uploadForm.planTime,upgradeType:this.uploadForm.upgradeType,vsoft:this.uploadForm.vsoft,vtype:this.uploadForm.vtype}).newPath){t.next=5;break}return this.$Message.error($t("routerMenu.error124")),t.abrupt("return",!1);case 5:if(1!=s.upgradeType||""!=s.planTime){t.next=8;break}return this.$Message.error($t("routerMenu.error125")),t.abrupt("return",!1);case 8:if(2!=+s.vtype||1==+this.uploadForm.upgradeType){t.next=25;break}return this.$store.commit("isErrorMsgShow",!1),t.next=12,u.a.sysVersionInsert(s,"_","",5e3);case 12:if(n=t.sent,this.$store.commit("isErrorMsgShow",!0),void 0!==n){t.next=22;break}return this.$refs.upload.clearFiles(),this.uploadVisbale=!1,this.$Message.success($t("routerMenu.operationSucces")),this.successTime=!0,c.a.set("token","",{expires:0}),e.myTimeOut=setInterval((function(){e.timeOut=e.timeOut-1,e.timeOut<=0&&(clearInterval(e.myTimeOut),e.successTime=!1,e.$router.push("/login"))}),1e3),t.abrupt("return");case 22:n&&(this.$refs.upload.clearFiles(),this.uploadVisbale=!1,this.$Message.success($t("routerMenu.operationSucces")),this.successTime=!0,c.a.set("token","",{expires:0}),e.myTimeOut=setInterval((function(){e.timeOut=e.timeOut-1,e.timeOut<=0&&(clearInterval(e.myTimeOut),e.$router.push("/login"))}),1e3)),t.next=29;break;case 25:return t.next=27,u.a.sysVersionInsert(s,"_");case 27:t.sent&&(this.$refs.upload.clearFiles(),this.uploadVisbale=!1,this.$Message.success($t("routerMenu.operationSucces")),this.init());case 29:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),handleUpPlan:function(t){0===t?(this.uploadForm.planTime="",this.planTimeStatus=!0):(this.uploadForm.planTime=o()().startOf("day").format("HH:mm"),this.planTimeStatus=!1)},beforeUpload:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};if(this.$store.commit("_loading",!0),t.size>209715200)return this.$Message.error($t("routerMenu.error126")),void this.$store.commit("_loading",!1);var s=t.name,n=s.indexOf("V");0!==n&&-1!==n&&(s=s.slice(n));var a=this.uploadForm.vtype;this.$refs.upload.clearFiles();var r=s.split("."),i=0==a?"apk":"zip";if(r[r.length-1]!==i)return this.$Message.error($t("routerMenu.error127")+i+$t("routerMenu.error128")),void this.$store.commit("_loading",!1);var o=[].concat(r).slice(0,r.length-1).join("."),u=/^V\d+.\d+.\d+.\d+.\d+.\d+/;return o.match(u)[0].length!==o.length&&"_"!==o[o.match(u)[0].length]?(this.$Message.error($t("routerMenu.error129")),void this.$store.commit("_loading",!1)):u.test(o)?(this.vsoft.split("_")[0].slice(1).split("."),s.split("_")[0].slice(1).split("."),this.uploadForm.vsoft=o,this.$store.commit("_loading",!0),e(!0)):(this.$Message.error($t("routerMenu.error129")),void this.$store.commit("_loading",!1))},isBig:function(t,e){return+t[0]>+e[0]||+t[0]==+e[0]&&!!t[1]&&this.isBig(t.slice(1),e.slice(1))},handleSuccess:function(t){this.uploadForm.newPath=t.data,this.$Message.success($t("routerMenu.uploadSuccess")),this.$store.commit("_loading",!1)},uploadError:function(t){this.$Message.success($t("routerMenu.error131")),this.$refs.upload.clearFiles(),this.$store.commit("_loading",!1)},showConfirm:function(){this.isModalVisible=!0},confirmClear:function(){this.isClearing=!0,this.clearData()},clearData:function(){var t=Object(r.a)(a.a.mark((function t(){var e;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,u.a.sysClearData();case 3:(e=t.sent)?(this.$Message.success({content:e.msg,duration:3}),this.isClearing=!1,this.isModalVisible=!1):this.isClearing=!1;case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},mounted:function(){this.init()}},h=(s("f15c"),s("2877")),f=Object(h.a)(d,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"i-table-no-border selection"},[s("div",{staticClass:"pageHeader"},[s("h4",[t._v(t._s(t.$t("routerMenu.softwareUpgrade")))]),s("div",{staticClass:"buttons"},[s("Button",{attrs:{icon:"md-refresh",loading:t.$store.state.loading},on:{click:function(e){return t.$emit("handleReload")}}},[t._v(t._s(t.$t("routerMenu.resetting")))]),0===t.userInfo.isSensData?s("Button",{attrs:{type:"success",icon:"md-cloud-upload",loading:t.$store.state.loading},on:{click:t.showModal}},[t._v(t._s(t.$t("routerMenu.uploadUpdate")))]):t._e(),0===t.userInfo.isSensData&&"admin"===t.userInfo.taccount?s("Button",{attrs:{type:"error",icon:"ios-trash-outline"},on:{click:t.showConfirm}},[t._v(t._s(t.$t("routerMenu.clearDataButtontext")))]):t._e()],1)]),s("Card",{staticClass:"ivu-mt",attrs:{bordered:!1,"dis-hover":""}},[s("Table",{ref:"table",staticClass:"ivu-mt",attrs:{height:t.data.length>=11?520:"",columns:t.columns,data:t.data,loading:t.$store.state.loading}}),s("div",{staticClass:"ivu-mt ivu-text-center"},[s("Page",{attrs:{current:t.searchForm.pageNum,total:t.total,"page-size":t.searchForm.pageSize,"page-size-opts":[10,20,50,100],"show-total":"","show-elevator":"","show-sizer":""},on:{"on-change":t.changePage,"on-page-size-change":t.changePageSize}})],1)],1),s("Modal",{attrs:{title:this.$t("routerMenu.upgradeVersion"),"mask-closable":!1},model:{value:t.uploadVisbale,callback:function(e){t.uploadVisbale=e},expression:"uploadVisbale"}},[s("Form",{attrs:{"label-width":100}},[s("FormItem",{attrs:{label:this.$t("routerMenu.versionType")}},[s("Select",{attrs:{clearable:!1},on:{"on-change":t.switchVtype},model:{value:t.uploadForm.vtype,callback:function(e){t.$set(t.uploadForm,"vtype",e)},expression:"uploadForm.vtype"}},t._l(t.vtypeList,(function(e){return s("Option",{key:e.vtype,attrs:{value:e.vtype}},[t._v(t._s(e.name))])})),1)],1),s("FormItem",{attrs:{label:this.$t("routerMenu.newVersion")}},[t._v("\n                "+t._s(t.vsoft)+"\n            ")]),s("FormItem",{attrs:{label:this.$t("routerMenu.versionFile")}},[s("x-upload",{ref:"upload",attrs:{name:"file","max-size":204800,headers:t.upHead,action:"/yard/sysVersion/uploadFile?vType="+t.uploadForm.vtype,"max-count":1,"before-upload":t.beforeUpload,"on-success":t.handleSuccess,"on-error":t.uploadError}},[s("Button",{attrs:{type:"dashed",icon:"ios-cloud-upload-outline"}},[t._v(t._s(t.$t("routerMenu.selectFile")))]),s("div",{staticClass:"file-des"},[t._v(t._s(t.$t("routerMenu.versionFormat"))+" : "+t._s(t.getVerName))])],1)],1),s("FormItem",{attrs:{label:this.$t("routerMenu.upgradeImmediately")}},[s("RadioGroup",{on:{"on-change":t.handleUpPlan},model:{value:t.uploadForm.upgradeType,callback:function(e){t.$set(t.uploadForm,"upgradeType",e)},expression:"uploadForm.upgradeType"}},[s("Radio",{attrs:{value:1,label:0}},[t._v(t._s(t.$t("routerMenu.yes")))]),s("Radio",{attrs:{value:1,label:1}},[t._v(t._s(t.$t("routerMenu.no")))])],1)],1),s("FormItem",{attrs:{label:this.$t("routerMenu.planTime")}},[s("TimePicker",{staticStyle:{width:"388px"},attrs:{format:"HH:mm",placeholder:this.$t("routerMenu.pleaseEnter"),clearable:!1,disabled:t.planTimeStatus,readonly:t.planTimeStatus},model:{value:t.uploadForm.planTime,callback:function(e){t.$set(t.uploadForm,"planTime",e)},expression:"uploadForm.planTime"}})],1)],1),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("Button",{attrs:{type:"text"},on:{click:function(e){t.uploadVisbale=!1}}},[t._v(t._s(t.$t("routerMenu.cancel")))]),s("Button",{attrs:{type:"primary",loading:t.$store.state._loading},on:{click:t.handleUpdate}},[t._v(t._s(t.$t("routerMenu.uploadUpdate")))])],1)],1),s("Modal",{attrs:{title:this.$t("routerMenu.backgroundUpgrade"),closable:!1,width:"380","mask-closable":!1},model:{value:t.successTime,callback:function(e){t.successTime=e},expression:"successTime"}},[s("p",{staticStyle:{position:"relative",width:"360px",height:"180px"}},[s("Spin",{attrs:{fix:""}},[s("Icon",{staticClass:"demo-spin-icon-load",attrs:{type:"ios-loading",size:58}}),s("div",{staticStyle:{"margin-top":"10px","font-size":"17px","min-width":"250px",position:"relative",bottom:"-20px"}},[t._v("\n                    "+t._s(t.timeOut)+" "+t._s(t.$t("routerMenu.exitSeconds")))]),s("div",{staticStyle:{"margin-top":"0px",width:"100%",color:"#999","text-align":"center","font-size":"13px",position:"relative",bottom:"-20px"}},[t._v("\n                    "+t._s(t.$t("routerMenu.error132")))])],1)],1),s("p",{attrs:{slot:"footer"},slot:"footer"})]),s("Modal",{attrs:{title:t.$t("routerMenu.clearModalTitle"),"mask-closable":!1,closable:!1,width:"420"},model:{value:t.isModalVisible,callback:function(e){t.isModalVisible=e},expression:"isModalVisible"}},[s("div",{staticClass:"modal-content"},[s("div",{staticClass:"warning-icon"},[s("Icon",{attrs:{type:"ios-warning",size:"60",color:"#ff9900"}})],1),s("h2",{staticClass:"modal-title"},[t._v(t._s(t.$t("routerMenu.confirmQuestion")))]),s("div",{staticClass:"divider"}),s("p",{staticClass:"warning-text",domProps:{innerHTML:t._s(t.$t("routerMenu.warningText"))}}),s("div",{staticClass:"data-list-container"},[s("ul",{staticClass:"data-list"},t._l(t.dataItems,(function(e,n){return s("li",{key:n},[s("Icon",{staticClass:"item-icon",attrs:{type:"ios-document-outline",size:"16",color:"#515a6e"}}),s("span",[t._v(t._s(e))])],1)})),0)]),s("div",{staticClass:"warning-footer"},[s("Icon",{attrs:{type:"ios-alert",size:"18",color:"#ed4014"}}),s("span",{domProps:{innerHTML:t._s(t.$t("routerMenu.irreversibleWarning"))}})],1)]),s("div",{staticClass:"modal-footer",attrs:{slot:"footer"},slot:"footer"},[s("Button",{attrs:{disabled:t.isClearing},on:{click:function(e){t.isModalVisible=!1}}},[t._v(t._s(t.$t("routerMenu.cancel")))]),s("Button",{staticClass:"confirm-button",attrs:{type:"error",loading:t.isClearing},on:{click:t.confirmClear}},[t.isClearing?s("span",[t._v(t._s(t.$t("routerMenu.clearing")))]):s("span",[t._v(t._s(t.$t("routerMenu.clearConfirmButton")))])])],1)])],1)}),[],!1,null,null,null);e.default=f.exports},a09b:function(t,e,s){"use strict";s("7f7f"),s("28a5"),s("ac6a");var n=s("bd86"),a=(s("c5f6"),s("099a")),r=s("5250"),i=s("3a27"),o="ivu-progress",u={name:"Progress",components:{Icon:r.a},props:{percent:{type:Number,default:0},successPercent:{type:Number,default:0},status:{validator:function(t){return Object(i.f)(t,["normal","active","wrong","success"])},default:"normal"},hideInfo:{type:Boolean,default:!1},strokeWidth:{type:Number,default:10},vertical:{type:Boolean,default:!1},strokeColor:{type:[String,Array]},textInside:{type:Boolean,default:!1}},data:function(){return{currentStatus:this.status}},computed:{isStatus:function(){return"wrong"==this.currentStatus||"success"==this.currentStatus},statusIcon:function(){var t="";switch(this.currentStatus){case"wrong":t="ios-close-circle";break;case"success":t="ios-checkmark-circle"}return t},bgStyle:function(){var t=this.vertical?{height:"".concat(this.percent,"%"),width:"".concat(this.strokeWidth,"px")}:{width:"".concat(this.percent,"%"),height:"".concat(this.strokeWidth,"px")};return this.strokeColor&&("string"==typeof this.strokeColor?t["background-color"]=this.strokeColor:t["background-image"]="linear-gradient(to right, ".concat(this.strokeColor[0]," 0%, ").concat(this.strokeColor[1]," 100%)")),t},successBgStyle:function(){return this.vertical?{height:"".concat(this.successPercent,"%"),width:"".concat(this.strokeWidth,"px")}:{width:"".concat(this.successPercent,"%"),height:"".concat(this.strokeWidth,"px")}},wrapClasses:function(){var t;return["".concat(o),"".concat(o,"-").concat(this.currentStatus),(t={},Object(n.a)(t,"".concat(o,"-show-info"),!this.hideInfo&&!this.textInside),Object(n.a)(t,"".concat(o,"-vertical"),this.vertical),t)]},textClasses:function(){return"".concat(o,"-text")},textInnerClasses:function(){return"".concat(o,"-text-inner")},outerClasses:function(){return"".concat(o,"-outer")},innerClasses:function(){return"".concat(o,"-inner")},bgClasses:function(){return"".concat(o,"-bg")},successBgClasses:function(){return"".concat(o,"-success-bg")}},created:function(){this.handleStatus()},methods:{handleStatus:function(t){t?(this.currentStatus="normal",this.$emit("on-status-change","normal")):100==parseInt(this.percent,10)&&(this.currentStatus="success",this.$emit("on-status-change","success"))}},watch:{percent:function(t,e){t<e?this.handleStatus(!0):this.handleStatus()},status:function(t){this.currentStatus=t}}},l=s("2877"),c=Object(l.a)(u,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:t.wrapClasses},[s("div",{class:t.outerClasses},[s("div",{class:t.innerClasses},[s("div",{class:t.bgClasses,style:t.bgStyle},[t.textInside?s("div",{staticClass:"ivu-progress-inner-text"},[t._v(t._s(t.percent)+"%")]):t._e()]),s("div",{class:t.successBgClasses,style:t.successBgStyle})])]),t.hideInfo||t.textInside?t._e():s("span",{class:t.textClasses},[t._t("default",[t.isStatus?s("span",{class:t.textInnerClasses},[s("Icon",{attrs:{type:t.statusIcon}})],1):s("span",{class:t.textInnerClasses},[t._v("\n                "+t._s(t.percent)+"%\n            ")])])],2)])}),[],!1,null,null,null).exports,p={name:"UploadList",components:{Icon:a.a,iProgress:c},props:{files:{type:Array,default:function(){return[]}}},data:function(){return{prefixCls:"ivu-upload"}},methods:{fileCls:function(t){return["".concat("ivu-upload","-list-file"),Object(n.a)({},"".concat("ivu-upload","-list-file-finish"),"finished"===t.status)]},handleClick:function(t){this.$emit("on-file-click",t)},handlePreview:function(t){this.$emit("on-file-preview",t)},handleRemove:function(t){this.$emit("on-file-remove",t)},format:function(t){var e=t.name.split(".").pop().toLocaleLowerCase()||"",s="ios-document-outline";return["gif","jpg","jpeg","png","bmp","webp"].indexOf(e)>-1&&(s="ios-image"),["mp4","m3u8","rmvb","avi","swf","3gp","mkv","flv"].indexOf(e)>-1&&(s="ios-film"),["mp3","wav","wma","ogg","aac","flac"].indexOf(e)>-1&&(s="ios-musical-notes"),["doc","txt","docx","pages","epub","pdf"].indexOf(e)>-1&&(s="md-document"),["numbers","csv","xls","xlsx"].indexOf(e)>-1&&(s="ios-stats"),["keynote","ppt","pptx"].indexOf(e)>-1&&(s="ios-videocam"),s},parsePercentage:function(t){return parseInt(t,10)}}},d=Object(l.a)(p,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ul",{class:[t.prefixCls+"-list"]},t._l(t.files,(function(e){return s("li",{class:t.fileCls(e),on:{click:function(s){return t.handleClick(e)}}},[s("span",{on:{click:function(s){return t.handlePreview(e)}}},[s("Icon",{attrs:{type:t.format(e)}}),t._v(" "+t._s(e.name)+"\n\t\t")],1),s("Icon",{directives:[{name:"show",rawName:"v-show",value:"finished"===e.status,expression:"file.status === 'finished'"}],class:[t.prefixCls+"-list-remove"],attrs:{type:"ios-close"},nativeOn:{click:function(s){return t.handleRemove(e)}}}),s("transition",{attrs:{name:"fade"}},[e.showProgress?s("i-progress",{attrs:{"stroke-width":2,percent:t.parsePercentage(e.percentage),status:"finished"===e.status&&e.showProgress?"success":"normal"}}):t._e()],1)],1)})),0)}),[],!1,null,null,null).exports;function h(t){var e=t.responseText||t.response;if(!e)return e;try{return JSON.parse(e)}catch(t){return e}}function f(t){if("undefined"!=typeof XMLHttpRequest){var e=new XMLHttpRequest,s=t.action;e.upload&&(e.upload.onprogress=function(e){e.total>0&&(e.percent=e.loaded/e.total*100),t.onProgress(e)});var n=new FormData;t.data&&Object.keys(t.data).map((function(e){n.append(e,t.data[e])})),n.append(t.filename,t.file),e.onerror=function(e){t.onError(e)},e.onload=function(){if(e.status<200||e.status>=300)return t.onError(function(t,e,s){var n="fail to post ".concat(t," ").concat(s.status,"'"),a=new Error(n);return a.status=s.status,a.method="post",a.url=t,a}(s,0,e),h(e));t.onSuccess(h(e))},e.open("post",s,!0),t.withCredentials&&"withCredentials"in e&&(e.withCredentials=!0);var a=t.headers||{};for(var r in a)a.hasOwnProperty(r)&&null!==a[r]&&e.setRequestHeader(r,a[r]);e.send(n)}}s("456d");var m=s("2507"),v=s("9f81"),g={name:"Upload",mixins:[m.a,v.a],components:{UploadList:d},props:{action:{type:String,required:!0},headers:{type:Object,default:function(){return{}}},multiple:{type:Boolean,default:!1},data:{type:Object},name:{type:String,default:"file"},withCredentials:{type:Boolean,default:!1},showUploadList:{type:Boolean,default:!0},type:{type:String,validator:function(t){return Object(i.f)(t,["select","drag"])},default:"select"},format:{type:Array,default:function(){return[]}},accept:{type:String},maxSize:{type:Number},beforeUpload:Function,onProgress:{type:Function,default:function(){return{}}},onSuccess:{type:Function,default:function(){return{}}},onError:{type:Function,default:function(){return{}}},onRemove:{type:Function,default:function(){return{}}},onPreview:{type:Function,default:function(){return{}}},onExceededSize:{type:Function,default:function(){return{}}},onFormatError:{type:Function,default:function(){return{}}},defaultFileList:{type:Array,default:function(){return[]}},paste:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{prefixCls:"ivu-upload",dragOver:!1,fileList:[],tempIndex:1}},computed:{classes:function(){var t;return["".concat("ivu-upload"),(t={},Object(n.a)(t,"".concat("ivu-upload","-select"),"select"===this.type),Object(n.a)(t,"".concat("ivu-upload","-drag"),"drag"===this.type),Object(n.a)(t,"".concat("ivu-upload","-dragOver"),"drag"===this.type&&this.dragOver),t)]}},methods:{handleClick:function(){this.itemDisabled||this.$refs.input.click()},handleChange:function(t){var e=t.target.files;e&&(this.uploadFiles(e),this.$refs.input.value=null)},onDrop:function(t){this.dragOver=!1,this.itemDisabled||this.uploadFiles(t.dataTransfer.files)},handlePaste:function(t){this.itemDisabled||this.paste&&this.uploadFiles(t.clipboardData.files)},uploadFiles:function(t){var e=this,s=Array.prototype.slice.call(t);this.multiple||(s=s.slice(0,1)),0!==s.length&&s.forEach((function(t){e.upload(t)}))},upload:function(t){var e=this;if(!this.beforeUpload)return this.post(t);this.beforeUpload(t,(function(s){s&&e.post(t)}))},post:function(t){var e=this;if(this.format.length){var s=t.name.split(".").pop().toLocaleLowerCase();if(!this.format.some((function(t){return t.toLocaleLowerCase()===s})))return this.onFormatError(t,this.fileList),!1}if(this.maxSize&&t.size>1024*this.maxSize)return this.onExceededSize(t,this.fileList),!1;this.handleStart(t),(new FormData).append(this.name,t),f({headers:this.headers,withCredentials:this.withCredentials,file:t,data:this.data,filename:this.name,action:this.action,onProgress:function(s){e.handleProgress(s,t)},onSuccess:function(s){e.handleSuccess(s,t)},onError:function(s,n){e.handleError(s,n,t)}})},handleStart:function(t){t.uid=Date.now()+this.tempIndex++;var e={status:"uploading",name:t.name,size:t.size,percentage:0,uid:t.uid,showProgress:!0};this.fileList.push(e),this.$emit("onProgress",{_file:e,fileList:this.fileList})},getFile:function(t){var e;return this.fileList.every((function(s){return!(e=t.uid===s.uid?s:null)})),e},handleProgress:function(t,e){var s=this.getFile(e);this.onProgress(t,s,this.fileList),s.percentage=t.percent||0,this.$emit("onProgress",{_file:s,fileList:this.fileList})},handleSuccess:function(t,e){var s=this.getFile(e);s&&(s.status="finished",s.response=t,this.onSuccess(t,s,this.fileList),this.dispatch("FormItem","on-form-change",s),setTimeout((function(){s.showProgress=!1}),1e3))},handleError:function(t,e,s){var n=this.getFile(s),a=this.fileList;n.status="fail",a.splice(a.indexOf(n),1),this.onError(t,e,s)},handleRemove:function(t){var e=this.fileList;e.splice(e.indexOf(t),1),this.onRemove(t,e)},handlePreview:function(t){"finished"===t.status&&this.onPreview(t)},clearFiles:function(){this.fileList=[]}},watch:{defaultFileList:{immediate:!0,handler:function(t){var e=this;this.fileList=t.map((function(t){return t.status="finished",t.percentage=100,t.uid=Date.now()+e.tempIndex++,t}))}}}},y=Object(l.a)(g,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:[t.prefixCls]},[s("div",{class:t.classes,on:{click:t.handleClick,drop:function(e){return e.preventDefault(),t.onDrop(e)},paste:t.handlePaste,dragover:function(e){e.preventDefault(),t.dragOver=!0},dragleave:function(e){e.preventDefault(),t.dragOver=!1}}},[s("input",{ref:"input",class:[t.prefixCls+"-input"],attrs:{type:"file",multiple:t.multiple,accept:t.accept},on:{change:t.handleChange}}),t._t("default")],2),t._t("tip"),t.showUploadList?s("upload-list",{attrs:{files:t.fileList},on:{"on-file-remove":t.handleRemove,"on-file-preview":t.handlePreview}}):t._e()],2)}),[],!1,null,null,null).exports;e.a=y},a50c:function(t,e,s){},f15c:function(t,e,s){"use strict";var n=s("a50c");s.n(n).a}}]);